INTRODUCTION
------------
T24DHW.DLL is a Win32 function library for California residential simulation 
software.  T24DHW.DLL encompasses the rules and required algorithms specified
in draft 2013 Residential ACM Manual Appendix E.

USING T2DHW.DLL
---------------
T24DHW.DLL's public functions are callable from any programming language 
that supports Win32 function libraries.  The functions assume C calling 
conventions, and strings are in ASCIIZ format.

Error messages are returned in a buffer supplied by the calling program.
As of version 2013.WH.01 the buffer must be at least 105 bytes.  All
T24DHW.DLL functions return an error message and it is the calling program's
responsibility to check for errors after each call to a T24DHW.DLL
function.  If no error was detected the error message string returned has
a length of zero bytes.

For typical use of T24DHW.DLL functions in simulating a single-family residence, the 
calling program will call T24DHWInit once for each simulation run to initialize the 
DHW data structures and weather files, define the DHW system parameters with 
T24DHWSystemInit and T24DHWItem, then call T24DHWHr hourly for domestic water 
heating energy use.  

T24DHWSF is an optional function for incorporating Solar Fractions in the simulation.
Calling details for all functions are shown below.

Multi-family recirculation loops between residences are simulated using the T24DHWRecircInit
and (optionally) T24DHWRecircPipe functions.

Dependant libraries:
        T24WTHR.DLL version 2013.W0.06 (12 January 2012) or later
        T24TDV.DLL   not used by T24DHW but some functions of T24WTHR.DLL require it
	T24ASM32.DLL general-purpose subroutines
	T24UNZIP.DLL used by T24WTHR.DLL to initialize weather tables

REVISION HISTORY
----------------

Version 2013.WH.56d: 07 July 2014

Fixed bug in small water heater size limits.  No other changes.


Version 2013.WH.56c: 20 June 2014

Fixed bugs related to boilers.  No other changes.


Version 2013.WH.56: 13 June 2014

Added 0.5 Solar Fraction to single-family Standard Design when natural gas not available
per Standards section 150.1(C)8d.

Extended valid range of heat pump water heater Energy Factor input to maximum of 4.0
Bug fixed in simulation of air-to-water heat pump with indirect tank


Version 2013.WH.55: 06 June 2014

LDEF calculation changed from hourly to annual


Version 2013.WH.54b: 28 May 2014

Bug fixed in simulation of ground-source heat pump with indirectly-fired tank.
Added heating source WHSRC_GSHP = 6 for ground-source heat pump.


Version 2013.WH.54a: 27 May 2014

Bug fixed in simulation of heat pump with indirectly-fired tank.


Version 2013.WH.53: 25 March 2014

Bug fixed in calculation of Proposed Design multi-family recirculation losses
when more than one water heating system is specified.  No other changes.


Version 2013.WH.52: 07 March 2014

Bug fixed in Standard Design with 8 dwelling units and multi-family recirculation.


Version 2013.WH.50: 03 February 2014

Standard Design energy source when Natural Gas is not available same as Proposed Design.
Updated Standard Design multi-family recirculation pump power calculations.


Version 2013.WH.49: 23 January 2014

Changed Standard Design when modelling any central multi-family system to include recirculation
when Proposed Design does not include recirculation.

Incorporates updated DSM factors for single-family recirculating systems.



Version 2013.WH.48: 13 January 2013

Added distribution system types for HERS-inspected Insulated Pipe Below Ground.


Version 2013.WH.47: 27 December 2013

Fixed bugs in multi-family Standard Design water heating systems.  Added error messages when multi-family
recirculation is modelled without central water heating system and when single-family residence is
modelled with central multi-family flag set.


Version 2013.WH.46: 16 December 2013

Distribution System Multipliers for single-family recirculating systems changed per Marc Hoeshcle
Non-compliant System flag disabled


Version 2013.WH.45: 03 December 2013

Bug fix in calculation of Standard Design water heaters when central multi-family system is modelled without
recirculation.  Additional parameter in T24DHWSystemInit function, please see details below.
Revised data area to reduce disk image size.


Version 2013.WH.43: 30 October 2013

Bug fix in multi-family recirculation simulations.  No other changes.


Version 2013.WH.42: 10 September 2013

Bug fix when simulating boilers.  No other changes.


Version 2013.WH.40: 14 June 2013

Bug fixes for Standard Design when simulating multi-family recirculating systems and natural gas 
is not available.  No other changes.  This version is not certified for compliance with California Title 24 code.


Version 2013.WH.39: 10 June 2013

Energy source for Standard Design when natural gas is not available changed to electric resistance.
No other changes.  This version is not certified for compliance with California Title 24 code.


Version 2013.WH.38: 29 May 2013

Optional fuel use detail added to T24DHWHr.  Bug fixes related to initialization of electric 
storage water heaters.  This version is not certified for compliance with California Title 24 code.


Version 2013.WH.37: 20 May 2013

Added 'natural gas present' parameter to T24DHWInit function.  Programs using older versions 
of this function will not work properly without modification.   See detailed description of 
T24DHWInit for additional information.

This version is not certified for compliance with California Title 24 code.


Version 2013.WH.36: 15 May 2013

Bug fixes.  Previous versions did not work correctly with oil-fired storage water heaters; Multi-family 
recirculation Standard Design did not simulate the correct number of recirculation loops in buildings 
with fewer than 8 dwelling units; calculation of standby losses for large storage water heaters were 
revised to reflect corrections in the ACM manual.

This version is not certified for compliance with California Title 24 code.


Version 2013.WH.35: 15 March 2013

Bug fixes.  Version before 2013.WH.34 do not calculate multiple single-family Standard Design 
simulations correctly when the number of water heaters is not equal to the number of dwelling units.

Versions before 2013.WH.35 do not calculate multi-family recirculation Standard Design simulations
correctly.

This version is not certified for compliance with California Title 24 code.


Version 2013.WH.33: 12 February 2013

Added runtime switch to enable 16 April 2015 change in Standard Design water heater energy factor.
This switch is set with the T24DHWHr() function.
This version is not certified for compliance with California Title 24 code.


Version 2013.WH.32: 29 January 2013

Bug fixes in multi-family recirculation calculations; added first version of T24DHWErr
error reporting function.
This version is not certified for compliance with California Title 24 code.


Version 2013.WH.31: 09 January 2013

Added hSys parameter to T24DHWSF function.  Single- and multi-family Standard Design calculations
updated to conform with 12/13/2012 draft RACM water heating document.
This version is not certified for compliance with California Title 24 code.


Version 2013.WH.30: 13 December 2012

Added Standard Design calculations to the module.  Standard Design calculations are returned 
when the flag DHWCALC_STD is passed to T24DHWHr().  Proposed Design calculations are returned 
when the DHWCALC_PROP is used.  See notes for T24DHWHr() below.
This version is not certified for compliance with California Title 24 code.


Version 2013.WH.28: 30 November 2012

Added multi-family distribution system type parameter to T24RecircInit() and option
flags parameter to T24DHWSystemInit().
This version is not certified for compliance with California Title 24 code.


Version 2013.WH.27: 31 October 2012

Initial release of support for 2013 multi-family recirculating system simulations.
This version is not certified for compliance with California Title 24 code.


Version 2013.WH.26: 02 October 2012

Conditioned space temperature parameter added to function T24DHWhr.  This parameter is
used only when simulating recirculating distribution systems and is otherwise ignored.
This version is not certified for compliance with California Title 24 code.


Version 2013.WH.25: 14 August 2012

Enabled support for non-compliance weather files in research mode.  No other changes.
This version is not certified for compliance with California Title 24 code.


Version 2013.WH.24: 06 Auguast 2012

Enabled support for hourly solar fractions.  No other changes.  This version is not 
certified for compliance with California Title 24 code.


Version 2013.WH.23: 25 June 2012

Bug fixes in recirculation initialization.  No other changes.  This version 
is not certified for compliance with California Title 24 code.


Version 2013.WH.21: 19 June 2012

Added central recirculating distribution types WHDIST2013_CRND,
WHDIST2013_CRM and WHDIST2013_CRD
This version is not certified for compliance with California Title 24 code.

Version 2013.WH.17: 05 June 2012

Fixed bug in recirc initialization subroutine to clear pipe records from
previous simulation.  This version is not certified for compliance with 
California Title 24 code.


Version 2013.WH.16: 18 May 2012

Maximum number of water heating systems increased to 100.
Maximum number of water heaters in each system increased to 100.
This version is not certified for compliance with California Title 24 code.

Version 2013.WH.15: 17 May 2012
Version 2013.WH.14: 15 May 2012

Bug fixes related to multiple water heaters.  This version is not certified for 
compliance with California Title 24 code.


Version 2013.WH.14: 15 May 2012

Several bug fixes for Heat Pump and Indirect systems.  This version is not certified 
for compliance with California Title 24 code.


Version 2013.WH.13: 03 May 2012

Bug fix in GPD calculation for 2013 simulations.  Bug fix allowing WHDIST_POU
distribution system type for 2008 simulations.  Additional diagnostic calculation
options in T24DHWHr.  This version is not certified for compliance with 
California Title 24 code.


Version 2013.WH.12: 11 April 2012

Bug fixes in recirculation calcs.  Options parameter added to T24RecircPipe in order
to specify extra insulation.  This version is not certified for compliance with 
California Title 24 code.


Version 2013.WH.11: 02 April 2012

Added support for recirculating DHW systems.

New functions:
T24DHWRecircInit - initializes recirculation subsystem for a water heating system.
T24DHWRecircPipe - defines a recirculation pipe for a recirculation subsystem.
This version is not certified for compliance with California Title 24 code.

Version 2013.WH.10: 14 March 2012

Added support for unfired storage tanks using type WHTYPE_IND.  Equal shares of 
energy loss from unfired tanks is assigned to all water heaters in the system.
Added new error message "Storage tank has no insulation."  This version is not 
certified for compliance with California Title 24 code.


Version 2013.WH.09: 05 March 2012

Separated electric and non-electric site energy use in T24DHWHr returned value,
added support for DHWCALC_SITEKW bit flag which returns electric site energy.

DHWCALC_SITE calculation control flag now returns only non-electric site energy.
To reduce execution time multiple calls to T24DHWHr with the same month, day and
hour parameters to return several calculated values skip re-calculation until 
month, day or hour is changed.

Fixed bug in calculations for boilers, clarified documentation for passing pilot
light energy in T24DHWItem function.  This version is not certified for compliance with 
California Title 24 code.



Version 2013.WH.08: 29 February 2012

*** Redundant parameters removed from T24DHWSystemInit funcion.  ***
Please refer to T24DHWSystemInit function prototype in T24DHW.PBI or this file
for more information.This version is not certified for compliance with 
California Title 24 code.

*** New parameters added to T24DHWItem function. ***
Please refer to T24DHWItem function prototype in T24DHW.PBI or this file
for more information.  This version is not certified for compliance with 
California Title 24 code.


Version 2013.WH.06: 15 February 2012
*** Added number of dwelling units parameter to T24DHWSystemInit function. ***
Please refer to T24DHWSystemInit function prototype in T24DHW.PBI or this file
for more information.  Clarification of CFA in T24DHWInit function.  Added 
T24DHWHr flags to calculate hourly results for 2008 standards and to return gallons/hr.
Several bug fixes.  This version is not certified for compliance with California 
Title 24 code.

Version 2013.WH.05: 07 February 2012
Fixed bug in gallons per day calculation, added day of week to gallons per hour.
Added DHWCALC_LOAD control flag to T24DHWHr.  This version is not certified for 
compliance with California Title 24 code.

Version 2013.WH.04: 03 February 2012
Added multiplier parameter to T24DHWItem function to provide for multiple identical 
items.  DHWCALC_STD calculation control disabled.  Added DHWCALC_LOAD calculation 
control option to T24DHWHr function to return DHW load instead of fuel.
Replaced dhw4pb.inc include file for PowerBASIC with include file t24dhw.pbi which
incorporates the multiplier and calculation control changes.
Fixed bug in SDLM calculation. This version is not certified for compliance with 
California Title 24 code.

Version 2013.WH.03: 30 January 2012
Revised T24DHWInit to initialize weather data; the calling program no longer needs 
to initialize the weather before using any T24DHW.DLL functions.  Minor bug fixes.
Copies DHW DLL version to caller's buffer.  This version is not certified for 
compliance with California Title 24 code.

Version 2013.WH.02: 17 January 2012
Revised single-family calculations to conform with algorithms and assumptions
in the draft 2013 RACM Appendix E.  This version is not certified for compliance
with California Title 24 code.

Version 2013.WH.01: 12 January 2012
T24DHWInit calling parameters and returned values revised to include error
messages and error codes.  T24DHWSF return value revised to conform with 
other functions, please review the documentation for this function.
Additional errors detected by most functions.  This version is not certified
for compliance with California Title 24 code.

Version 2013.WH.00: 05 July 2011
Developmental version, with simulation code for single-family, proposed design
only.  Includes conditional assembly switch MATCH2008 to use 2008 rules and
data instead of updated ground temperatures and water temperatures proposed
for 2013 ACM rules.  This version is not presently certified for compliance
with California Title 24 code.

---------
T24DHWErr
---------
Writes a simulator status file to the current working directory with DHW system parameters.
This is intended to assist de-bugging run-time errors.

PowerBASIC prototype:
DECLARE FUNCTION T24DHWErr CDECL LIB "T24DHW.DLL" ALIAS "T24DHWErr"

This function has no parameters.  The simulator status file is named t24dhw.err and each call
to this function will overwrite any existing file of the same name.


----------
T24DHWInit
----------
Initializes DHW data and tables.  This function must be called before calling
other T24DHW.DLL functions.  The function fails returning an error code if an
error occurred during processing.  An error message is copied to the caller's
buffer at pErr.  On successful initialization the function returns 0 and clears
the caller's error message buffer.

PowerBASIC prototype:
DECLARE FUNCTION T24DHWInit CDECL LIB "T24DHW.DLL" ALIAS "T24DHWInit" _
    (BYVAL CFA AS LONG, _           ' Conditioned Floor Area of the entire building being simulated.
     BYVAL nUnits AS LONG, _        ' number of housing units simulated.
     BYVAL STORIES AS LONG, _       ' the number of stories in the simulated building.
     BYVAL CZ AS LONG, _            ' California Climate Zone 1-16
     BYVAL isNG AS LONG, _          ' flags 'natural gas present on site'
     BYVAL pVer AS DWORD, _         ' pointer to caller's version buffer
     BYVAL pErr AS DWORD _          ' pointer to caller's error buffer
    ) AS LONG

CFA:     Conditioned Floor Area of the building being simulated.

STORIES: the number of stories in the simulated building.

nUnits:  number of housing units simulated.

CZ:      California Climate Zone 1-16.
         To use the DLL in research mode with external weather files, first initialize the weather with
         T24InitWthrResearch (see T24WTHR.TXT) and when calling T24DHWInit use CZ = -1.  Using this feaure,
         HPAF defaults to 1.0 (see draft 2013 RACM Table RE-6).  Research mode is not certified for
         compliance with California Title 24 code.

isNG:    0 indicates natural gas not available at building site, meaning Standard Design calculations 
         assume propane is used.  Any other value indicates natural gas is avaiable and is assumed to 
         be used in Standard Design simulations.

pVer:    pointer to calling program's version buffer.  T24DHWInit copies the DLL's version
         identifier string to this buffer.  This buffer must be at least 28 bytes (80 bytes 
         recommended for compatability with future versions).

pErr:    pointer to calling program's error message buffer.  An error message is returned 
         in case an error was detected, otherwise the buffer contains a nul string.

Error Messages:
         'Invalid Climate Zone.  Climate Zone must be between 1 and 16.'
         'CFA for building must be greater than zero.',0
         'Number of dwelling units must be greater than zero.',0
         'Number of stories per unit must be greater than zero.',0


----------
T24DHWItem
----------
Add a water heater or storage tank to water heating system tables initialized with T24DHWSystemInit.  An error
message will be returned if this function is called before T24DHWSystemInit.

PowerBASIC prototype:
DECLARE FUNCTION T24DHWItem CDECL LIB "T24DHW.DLL" ALIAS "T24DHWItem" _
    (BYVAL hSys AS LONG, _          ' DHW system HANDLE returned by T24DHWSystemInit
     BYVAL iFuel AS LONG, _         ' fuel source index [described in text below]
     BYVAL iTYPE AS LONG, _         ' type index for allowed items [described in text below]
     BYVAL iInput AS LONG, _        ' input rating: watts for electric, Btu/hr for gas
     BYVAL EF AS SINGLE, _          ' energy factor or efficiency
     BYVAL tkVOL AS LONG, _         ' tank volume, gallons
     BYVAL n AS LONG, _             ' number of identical items
     BYVAL RTI AS SINGLE, _         ' tank interior insulation R-value
     BYVAL REI AS SINGLE, _         ' tank exterior insulation R-value
     BYVAL ambient AS LONG, _       ' index to indicate item ambient conditions
     BYVAL sbl AS SINGLE, _         ' standby Loss, fraction of input rating
     BYVAL pErr AS DWORD _          ' pointer to caller's error buffer
    ) AS LONG


hSys:    DHW system handle returned by T24DHWSystemInit

iFuel:   Fuel source index as defined in T24DHW.INC
         WHSRC_ER = 0   ; electric resistance
         WHSRC_NG = 1   ; natural gas
         WHSRC_PR = 2   ; propane
         WHSRC_HP = 3   ; air-source heat pump
         WHSRC_OIL = 4  ; oil
         WHSRC_GSHP = 6 ; ground-source heat pump


iTtype:  Item type index for allowed items
          WHTYPE_BOIL =     0		; boiler
          WHTYPE_IND =      1		; indirectly-fired tank
          WHTYPE_LINST =    2		; large instantaneous
          WHTYPE_LSTOR =    3		; large storage
          WHTYPE_LTANKLES = 4		; large tankless
          WHTYPE_SINST =    5		; small instantaneous
          WHTYPE_SSTOR =    6		; small storage
          WHTYPE_STO =      7           ; unfired storage tank - deprecated, do not use
          WHTYPE_STANKLES = 8		; small tankless

iInput:  Item input rating: watts for electric, Btu/hr for gas
         Ignored for unfired and indirectly-fired storage tanks

EF:      (float)
         Energy Factor for Small Gas, Oil, Propane or Electric Storage Heaters, and
         small Gas or Electric instantaneous water heaters, from 0.0 to 1.0

         Energy Factor for Heat Pump water heaters, from 1.0 to 3.0

         Efficiency for large Gas or oil storage water heaters, 0.0 to 1.0

         COP47 for ground-source heat pump, 1.0 to 5.0

tkVol:   tank volume, gallons

n:       number of identical items

RTI:     R-value of internal tank insulation, used only for indirectly-fired tanks

REI:     R-value of external tank insulation, used only for indirectly-fired tanks

ambient: index to indicate item ambient conditions.
          -1 = conditioned space, WthrDB (t24wthr.inc) = unconditioned space, WthrTG (t24wthr.inc) = ground, etc.

sbl:     for Large Electric Storage, Large  Gas or Oil Storage and Mini-Tank Electric Water Heaters:
          Standby Loss, fraction of input rating * iInput.  Watts for electric water heaters or
          Btu/hr for gas or oil water heaters.
         for Large Instantaneous, Indirect Gas and Hot Water Supply Boilers:
          pilot energy, Btu/hr
         ignored for small water heaters and indirectly-fired tanks

pErr:    pointer to caller's error message buffer.  An error message is returned in case an error was detected, otherwise
         the buffer contains a nul string.

Error messages:
         'Invalid Water Heating system in T24DHWItem.'
         'Unknown water heater type.'
         'Invalid ambient temperature index in T24DHWItem.'
         'Water Heater Input Rating too small for Large Storage water heater'
         'Tank volume less than zero.'
         'Energy Factor zero or less.'
         'Energy Factor greater than 1.'
         'Storage tank has no insulation.'

Returns: Error code.  The error code is zero if no errors were detected.

----------------
T24DHWSystemInit
----------------

Please note: t24dhw.dll version 45 includes an additional parameter (isCentral) which flags a central multi-family 
water heating system.

Initializes a DHW system.  A DHW system includes one or more water heaters and/or storage tanks and a distribution system.
A building simulation may include more than one DHW system.  Returns a handle for subsequent access to the simulation 
data tables, such as adding a water heater or storage tank to the simulation.

The handle hSys returned is an index to the simulator's data tables and is expected to be in the range of 1 to
MAXSYS (as defined in dhw.inc).  Any value greater than MAXSYS represents an error code in the high 16 bits
of the returned value.  The hSys handle is used to identify the DHW system to the DLL when using T24DHWItem to
add items to the simulation.

Errors may be detected either by testing the the returned value for a number greater than MAXSYS or by testing the
length of the error message.  If no error was detected the error message string will have a zero length and the high
word of the returned value will be zero.

PowerBASIC prototype:
DECLARE FUNCTION T24DHWSystemInit CDECL LIB "T24DHW.DLL" ALIAS "T24DHWSystemInit" _
    (BYVAL DIST AS LONG, _            ' Distribution system type index
     BYVAL isCENTRAL AS LONG, _       ' flags central multi-family system
     BYVAL SYSTEM_OPTIONS AS LONG, _  ' option flags for DHW system
     BYVAL pErr AS DWORD _            ' pointer to caller's error buffer
    ) AS LONG

DIST:           Distribution system type index as defined in T24DHW.PBI
                WHDIST2013_STD = (15 << 16)        ' Standard
                WHDIST2013_PIA = (16 << 16)        ' pipe insulation, all lines
                WHDIST2013_IPBG = (17 << 16)       ' insulated and protected pipe below grade
                WHDIST2013_PP = (18 << 16)         ' parallel piping
                WHDIST2013_RND = (19 << 16)        ' recirculation, non-demand control
                WHDIST2013_RDMan = (20 << 16)      ' recirculation, demand control push button
                WHDIST2013_RDAuto = (21 << 16)     ' recurculation, demand control occupancy/motion
                HERS_REQUIRED = (1 << 31)
                WHDIST2013_HERSPIA = WHDIST2013_PIA OR HERS_REQUIRED        ' pipe insulation, all lines
                WHDIST2013_HERSIPBG = WHDIST2013_IPBG OR HERS_REQUIRED      ' insulated and protected pipe below grade
                WHDIST2013_HERSPP = WHDIST2013_PP OR HERS_REQUIRED          ' parallel piping
                WHDIST2013_HERSRND = WHDIST2013_RND OR HERS_REQUIRED        ' recirculation, non-demand control
                WHDIST2013_HERSRDMan = WHDIST2013_RDMan OR HERS_REQUIRED    ' recirculation, demand control push button
                WHDIST2013_HERSRDAuto = WHDIST2013_RDAuto OR HERS_REQUIRED  ' recurculation, demand control occupancy/motion
                WHDIST2013_HERSPOU = (22 << 16) OR HERS_REQUIRED            ' point of use
                WHDIST2013_HERSCDS = (23 << 16) OR HERS_REQUIRED            ' compact distribution system

isCENTRAL:      indicates a central multi-family water heating system
                0 = not a central multi-family system
                1 = the water heating system serves more than one dwelling unit
                this parameter is ignored for single-family systems and defaults to 1 if a multi-family recirculating 
                system is specified (see T24DHWRecircInit).

SYSTEM_OPTIONS: bit flags to enable calculation options, only one so far
                SYSTEM_NONCOMPLIANT = 1              ' flags a non-compliant DHW system

pErr:  	        Pointer to calling program's error message buffer.  The buffer must be at least 150 bytes long.
                If no error is detected a nul string is returned in the buffer.

Error Messages:
        'Too many water heating systems.  Maximum number is 100.'
        'Unknown distribution system type in T24DHWSystemInit.'
        'Central water heating system not applicable with only one dwelling unit.'


--------
T24DHWHr
--------
Returns (float) DHW energy consumption for a given hour.
T24DHWInit and T24DHWSystemInit must have been previously called to initialize
the DHW data, and at least one water heater must have been added to the 
system with T24DHWItem.

PowerBASIC prototype:
DECLARE FUNCTION T24DHWHr CDECL LIB "T24DHW.DLL" ALIAS "T24DHWHr" _
    (BYVAL MONTH AS LONG, _         ' month
     BYVAL DAY AS LONG, _           ' day
     BYVAL HOUR AS LONG, _          ' hour
     BYVAL TEMPERATURE AS SINGLE, _ ' hourly conditioned air space temperature
     BYVAL FLAGS AS LONG, _         ' calculation control bits
     BYVAL pErr AS DWORD _          ' pointer to caller's error buffer
    ) AS SINGLE

MONTH:  (long) 1-12

DAY:    (long) 1-(28, 30, or 31 depending on the MONTH)

HOUR:   (long) 1-24

TEMPERATURE: (single) hourly conditioned space air temperature, F

FLAGS:  (long) calculation control bits

         %DHWCALC_STD triggers Standard Design calculations.
         %DHWCALC_PROP triggers Proposed Design calculations.
            %DHWCALC_STD and %DHWCALC_PROP are mutually exclusive; using the OR operator they are 
            combined with the following calculation control bits.

         %DHWCALC_2015 enables 16 April 2015 and later energy factor calculations for Standard Design.
            This bit is used only on the first call to T24DHWHr() for each simulation and is combined
            with any other control bits using the OR operator.

         Data fields returned by T24DHWHr are controlled by the following equates, which are
         defined (for PowerBASIC) in the file T24DHW.PBI.  These equates may not be combined.
         Equation references are found in draft 2013 RACM Appendix E.  Most of these equates
         are intended primarily for diagnostic purposes.  Ordinarily only %DHWCALC_SITE and 
         %DHWCALC_SITEKW will be used for building simulations.  These control bits are mutually
         exclusive.

         %DHWCALC_LOAD returns Btu load at the fixtures (HARL).
         %DHWCALC_GPH returns gallons used in the hour.
         %DHWCALC_SITE returns site non-electric energy consumption in Btu.
         %DHWCALC_SITEKW returns site electric energy consumption in kW.
         %DHWCALC_SCH returns the draw schedule for the hour.
         %DHWCALC_TG returns the calculated ground temperature for the hour.
            For 2013 simulations this is not the same as the supply temperature
         %DHWCALC_TS returns the water inlet (supply) temperature.
            For 2008 simulations this should be the same as the ground temperature.
         %DHWCALC_HSEU returns the Hourly Standard End Use in Btu (Equation RE-2).
         %DHWCALC_RCHRDL returns the Hourly Recirculation Distribution Loss in Btu (Equation RE-14).
         %DHWCALC_SSF returns the Solar Savings Fraction (unitless)
         %DHWCALC_DLM returns the Distribution Loss Multiplier (unitless, Equation RE-4).
         %DHWCALC_RCHRLL returns the Hourly Recirculation Loop pipe heat Loss in Btu (Equation RE-11).
         %DHWCALC_RCHRBL returns the Hourly Recirculation Branch pipe heat Loss in Btu (Equation RE-19).
         %DHWCALC_SITE_NG returns hourly natural gas use in Btu.
            This value is a component of %DHWCALC_SITE.
         %DHWCALC_SITE_PR returns hourly propane use in Btu.
            This value is a component of %DHWCALC_SITE.
         %DHWCALC_SITE_OIL returns hourly oil use in Btu.
            This value is a component of %DHWCALC_SITE.
         %DHWCALC_SITE_ER returns hourly electric resistance energy use in kW.
            This value is a component of %DHWCALC_SITEKW.
         %DHWCALC_SITE_HP returns hourly electric heat pump energy use in kW.
            This value is a component of %DHWCALC_SITEKW.
         %DHWCALC_SITE_PUMP returns hourly recirculation pump energy use in kW.
            This value is a component of %DHWCALC_SITEKW.


pErr:    pointer to caller's error message buffer.  An error message is returned
         in case an error was detected, otherwise the buffer will contain a nul string.

Returns (float) if FLAGS bit 1 is set, returns hourly DHW load (HARL) in Btu at the fixtures
                if FLAGS bit 1 is clear, returns hourly DHW site energy consumption in Btu 
                after system efficiency.

Error Messages:
         'Bad month index in hourly simulation.  Month index must be between 1 and 12.'
         'Bad day index in hourly simulation.  Day index must be between 1 and the number of days in the month.'
         'Bad hour index in hourly simulation.  Hour index must be between 1 and 24.'
         'Unknown results field index in T24DHWHr.'
         'Recirculation system has too few supply pipes.  Three supply pipes required.'
         'Recirculation system has too few return pipes.  Three return pipes required.'


----------------
T24DHWRecircInit
----------------
(Optional) initialize T24 DHW multi-family recirculation functions.
The T24 multi-family recirculation functions are used to simulate recirculation systems between multiple
dwelling units.  This recirculation loop is simulated in addition to the distribution systems within each
dwelling unit initialized by T24DHWSystemInit.

PowerBASIC prototype:
DECLARE FUNCTION T24DHWRecircInit CDECL LIB "T24DHW.DLL" ALIAS "T24DHWRecircInit" _
    (BYVAL hSys AS LONG, _                ' DHW system handle, from T24DHWSystemInit
     BYVAL MFDIST AS LONG, _              ' multi-family distribution loop type
     BYVAL RECIRC_OPTIONS AS LONG, _      ' calculation control bit flag(s)
     BYVAL nLoops AS LONG, _              ' number of loops, ignored if not HERS
     BYVAL pPwr AS SINGLE, _              ' recirculation pump power, bhp
     BYVAL pEff AS SINGLE, _              ' pump efficiency, 0.0 - 1.00
     BYVAL pErr AS DWORD _                ' pointer to error message buffer
    ) AS LONG

hSys:    DHW system handle returned by T24DHWSystemInit

MFDIST:  type of distribution system between dwelling units.  Valid types:
         WHDIST2013_CRND = multi-family central recirc non-demand control
         WHDIST2013_CRM = multi-family central recirc monitoring
         WHDIST2013_CRD = multi-family central demand recirc - standard design for new construction
         WHDIST2013_HERSCRND = multi-family central recirc non-demand control with HERS verification
         WHDIST2013_HERSCRM = multi-family central recirc monitoring with HERS verification
         WHDIST2013_HERSCRD = multi-family central demand recirc with HERS verification

RECIRC_OPTIONS: calculation control bit flag(s)
         RCOPTION_XINS = recirculation loop has extra insulation

nLoops:  number of recirculation loops.  This parameter is ignored with distribution system
         types other than WHDIST2013_HERSCRND, WHDIST2013_HERSCRM, and WHDIST2013_HERSCRD.

pPwr:    recurculation pump power for a single loop, bhp

pEff:    recirculation pump efficiency, 0.0 to 1.0

pErr:    pointer to calling program's error message buffer.  An error message is returned
         in case an error was detected, otherwise the buffer will contain a nul string.

Error messages:
         'Recirculation system not applicable with system distribution type.'
         'Recirculation pump efficiency must be between 0 and 1.'
         'Cannot model multi-family recirculation with non-central water heating system.'

The value returned by this function is an error code (in addition to error messages).  If the
error code is zero, no error was detected.


----------------
T24DHWRecircPipe
----------------

(optional) defines a recirculation pipe in a multi-family recirculation system loop
initialized by T24DHWRecircInit.

Simulating a multi-family recirculation system requires that three supply pipes and three
return pipes be defined.  The pipes are defined sequentially, i.e., the first supply pipe is
assumed to be connected the the hot water supply, the second supply pipe is assumed to be
connected to the first supply pipe, and the third supply pipe is assumed to be connected to
the second supply pipe.  The first return pipe is assumed to be connected to the third supply
pipe, the second return pipe is assumed to be connected to the first return pipe, and the third
return pipe is assumed to be connected to the second return pipe.

This function is optional when simulating a multi-family recirculation loop.  If the calling program
does not define the recirculation pipes the simulation is performed using defintions for a default 
multi-family recirculation loop.

PowerBASIC prototype:
DECLARE FUNCTION T24WHRecircPipe CDECL LIB "T24DHW.DLL" ALIAS "T24WHRecircPipe" _
    (BYVAL hSys AS DWORD, _          ' DHW System handle from T24DHWSystemInit
     BYVAL PipeType AS LONG, _       ' supply or return
     BYVAL Length AS SINGLE, _       ' ft
     BYVAL Diameter AS SINGLE, _     ' inches
     BYVAL Ambient AS DWORD, _       ' WthrDB, etc.
     pErr AS DWORD) _
    ) AS LONG

hSys:     DHW system handle returned by T24DHWSystemInit

PipeType: PIPETYPE_SUPPLY or PIPETYPE_RETURN as defined in t24dhw.inc and t24dhw.pbi

Length:   length of pipe section in feet.

Diameter: pipe inside diameter in inches.

Ambient:  ambient conditions index, as defined in t24dhw.inc and t24dhw.pbi.

          Valid indexes are:
           PIPELOC_COND               ' conditioned space
           PIPELOC_SC                 ' semi-conditioned space
           PIPELOC_UC                 ' unconditioned space
           PIPELOC_UG                 ' underground, buried in slab, or under slab

pErr:     pointer to caller's error message buffer.  An error message is returned
          in case an error was detected, otherwise the buffer will contain a nul string.

Error messages:
         'Recirculation system has not been initialized.'
         'Too many Supply pipes.  Maximum number is 3.'
         'Too many Return pipes.  Maximum number is 3.'
         'Unknown recurculation pipe ambient conditions.'

The value returned by this function is an error code (in addition to error messages).  If the
error code is zero, no error was detected.



--------
T24DHWSF
--------
(Optional) initializes T24DHW.DLL Solar Fractions functions
Solar Fractions, if used, should only be initalized after calling T24DHWInit, above.
If T24DHWSF is called more than once all except the last call are ignored.

PowerBASIC prototype:
DECLARE FUNCTION T24DHWSF CDECL LIB "T24DHW.DLL" ALIAS "T24DHWSF" _
    (BYVAL hSys AS DWORD, _         ' DHW system handle
     BYVAL pSF AS DWORD, _          ' pointer to array of up TO 8760 Solar Fractions
     BYVAL iSF AS LONG, _           ' an index that tells T24DHWSF what size the array of the Solar Fractions is
     BYVAL pErr AS DWORD _          ' pointer to caller's error buffer
    ) AS LONG

hSys:    DHW system handle returned by T24DHWSystemInit
pSF:     pointer to array of up to 8760 Solar Fractions.  The array must be DOUBLE floats.

iSF:       an index that tells T24DHWSF what size the array of the Solar Fractions is.
           0 = annual Solar Fraction.  The array of solar fractions consists of one value.
           1 = monthly Solar Fractions.  The array of solar fractions consists of 12 values.
           2 = daily Solar Fractions.  The array of solar fractions consists of 365 values.
           3 = hourly Solar Fractions.  An array of hourly Solar Fractions consists of 8760 values.

         As of 30 January 2012 the correct index for compliance with Title 24 Standards
         has not been established.  An array of daily Solar Fractions (iSF = 2) will
         be the same format and size as the output from T24SOLAR.DLL's T24SolarDHW
         function.

pErr:    pointer to caller's error message buffer.  An error message is returned
         in case an error was detected, otherwise the buffer will contain a nul string.

Returns: non-zero error code if the function failed.  The code is zero for success. 

Error Messages:
         'Solar Fraction period index not supported'
